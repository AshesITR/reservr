<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Compile a Keras model for truncated data under dist — tf_compile_model • reservr</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Compile a Keras model for truncated data under dist — tf_compile_model" />
<meta property="og:description" content="Compile a Keras model for truncated data under dist" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">reservr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/distributions.html">Working with Distributions</a>
    </li>
    <li>
      <a href="../articles/tensorflow.html">TensorFlow Integration</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/AshesITR/reservr/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Compile a Keras model for truncated data under dist</h1>
    <small class="dont-index">Source: <a href='https://github.com/AshesITR/reservr/blob/master/R/tf_compile.R'><code>R/tf_compile.R</code></a></small>
    <div class="hidden name"><code>tf_compile_model.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Compile a Keras model for truncated data under dist</p>
    </div>

    <pre class="usage"><span class='fu'>tf_compile_model</span><span class='op'>(</span>
  <span class='va'>inputs</span>,
  <span class='va'>intermediate_output</span>,
  <span class='va'>dist</span>,
  <span class='va'>optimizer</span>,
  censoring <span class='op'>=</span> <span class='cn'>TRUE</span>,
  truncation <span class='op'>=</span> <span class='cn'>TRUE</span>,
  metrics <span class='op'>=</span> <span class='cn'>NULL</span>,
  sample_weight_mode <span class='op'>=</span> <span class='cn'>NULL</span>,
  weighted_metrics <span class='op'>=</span> <span class='cn'>NULL</span>,
  target_tensors <span class='op'>=</span> <span class='cn'>NULL</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>inputs</th>
      <td><p>List of keras input layers</p></td>
    </tr>
    <tr>
      <th>intermediate_output</th>
      <td><p>Intermediate model layer to be used as input to
distribution parameters</p></td>
    </tr>
    <tr>
      <th>dist</th>
      <td><p>A <code>Distribution</code> to use for compiling the loss and parameter
outputs</p></td>
    </tr>
    <tr>
      <th>optimizer</th>
      <td><p>String (name of optimizer) or optimizer instance. For most
models, this defaults to <code>"rmsprop"</code></p></td>
    </tr>
    <tr>
      <th>censoring</th>
      <td><p>A flag, whether the compiled model should support censored
observations. Set to <code>FALSE</code> for higher efficiency. <code><a href='https://generics.r-lib.org/reference/fit.html'>fit(...)</a></code> will error if
the resulting model is used to fit censored observations.</p></td>
    </tr>
    <tr>
      <th>truncation</th>
      <td><p>A flag, whether the compiled model should support truncated
observations. Set to <code>FALSE</code> for higher efficiency. <code><a href='https://generics.r-lib.org/reference/fit.html'>fit(...)</a></code> will warn if
the resuting model is used to fit truncated observations.</p></td>
    </tr>
    <tr>
      <th>metrics</th>
      <td><p>List of metrics to be evaluated by the model during training
and testing. Each of this can be a string (name of a built-in function),
function or a <code>keras$metrics$Metric</code> class instance. See
<code>?tf$keras$metrics</code>. Typically you will use <code>metrics=list('accuracy')</code>. A
function is any callable with the signature <code>result = fn(y_true, y_pred)</code>.
To specify different metrics for different outputs of a multi-output model,
you could also pass a dictionary, such as <code>metrics=list(output_a = 'accuracy', output_b = c('accuracy', 'mse'))</code>. You can also pass a list to
specify a metric or a list of metrics for each output, such as
<code>metrics=list(list('accuracy'), list('accuracy', 'mse'))</code> or
<code>metrics=list('accuracy', c('accuracy', 'mse'))</code>. When you pass the strings
<code>'accuracy'</code> or <code>'acc'</code>, this is converted to one of
<code>tf.keras.metrics.BinaryAccuracy</code>, <code>tf.keras.metrics.CategoricalAccuracy</code>,
<code>tf.keras.metrics.SparseCategoricalAccuracy</code> based on the loss function
used and the model output shape. A similar conversion is done for the
strings <code>'crossentropy'</code> and <code>'ce'</code>.</p></td>
    </tr>
    <tr>
      <th>sample_weight_mode</th>
      <td><p>If you need to do timestep-wise sample weighting
(2D weights), set this to "temporal". <code>NULL</code> defaults to sample-wise
weights (1D). If the model has multiple outputs, you can use a different
<code>sample_weight_mode</code> on each output by passing a list of modes.</p></td>
    </tr>
    <tr>
      <th>weighted_metrics</th>
      <td><p>List of metrics to be evaluated and weighted by
<code>sample_weight</code> or <code>class_weight</code> during training and testing.</p></td>
    </tr>
    <tr>
      <th>target_tensors</th>
      <td><p>By default, Keras will create a placeholder for the
model's target, which will be fed with the target data during training. If
instead you would like to use your own target tensor (in turn, Keras will
not expect external data for these targets at training time), you can
specify them via the <code>target_tensors</code> argument. It should be a single
tensor (for a single-output sequential model).</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A <code>reservr_keras_model</code> that can be used to train truncated
and censored observations from <code>dist</code> based on input data from <code>inputs</code>.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='va'>dist</span> <span class='op'>&lt;-</span> <span class='fu'><a href='dist_exponential.html'>dist_exponential</a></span><span class='op'>(</span><span class='op'>)</span>
<span class='va'>params</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>rate <span class='op'>=</span> <span class='fl'>1.0</span><span class='op'>)</span>
<span class='va'>N</span> <span class='op'>&lt;-</span> <span class='fl'>100L</span>
<span class='va'>rand_input</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span><span class='op'>(</span><span class='va'>N</span><span class='op'>)</span>
<span class='va'>x</span> <span class='op'>&lt;-</span> <span class='va'>dist</span><span class='op'>$</span><span class='fu'>sample</span><span class='op'>(</span><span class='va'>N</span>, with_params <span class='op'>=</span> <span class='va'>params</span><span class='op'>)</span>

<span class='va'>tf_in</span> <span class='op'>&lt;-</span> <span class='fu'>keras</span><span class='fu'>::</span><span class='fu'><a href='https://keras.rstudio.com/reference/layer_input.html'>layer_input</a></span><span class='op'>(</span><span class='fl'>1L</span><span class='op'>)</span>
<span class='va'>mod</span> <span class='op'>&lt;-</span> <span class='fu'>tf_compile_model</span><span class='op'>(</span>
  inputs <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='va'>tf_in</span><span class='op'>)</span>,
  intermediate_output <span class='op'>=</span> <span class='va'>tf_in</span>,
  dist <span class='op'>=</span> <span class='va'>dist</span>,
  optimizer <span class='op'>=</span> <span class='fu'>keras</span><span class='fu'>::</span><span class='fu'><a href='https://keras.rstudio.com/reference/optimizer_adam.html'>optimizer_adam</a></span><span class='op'>(</span><span class='op'>)</span>,
  censoring <span class='op'>=</span> <span class='cn'>FALSE</span>,
  truncation <span class='op'>=</span> <span class='cn'>FALSE</span>
<span class='op'>)</span>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Alexander Rosenstock.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


