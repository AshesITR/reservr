<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Fit Distributions and Neural Networks to Censored and Truncated
    Data • reservr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Fit Distributions and Neural Networks to Censored and Truncated
    Data">
<meta property="og:description" content="Tools for defining distribution families and fitting them to
    interval-censored and interval-truncated data, where the truncation
    bounds may depend on the individual observation.  The defined
    distributions feature density, probability, sampling and fitting
    methods as well as efficient implementations of the log-density log
    f(x) and log-probability log P(x0 &lt;= X &lt;= x1) for use in TensorFlow
    neural networks via the tensorflow package. Allows training
    parametric neural networks on interval-censored and interval-truncated
    data with flexible parametrization. Applications include Claims
    Development in Non-Life Insurance, e.g. modelling reporting delay
    distributions from incomplete data.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">reservr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/distributions.html">Working with Distributions</a>
    </li>
    <li>
      <a href="articles/tensorflow.html">TensorFlow Integration</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/AshesITR/reservr/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="reservr" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#reservr" class="anchor"></a>reservr</h1></div>
<!-- badges: start -->

<p>The goal of reservr is to provide a flexible interface for specifying distributions and fitting them to (randomly) truncated and possibly interval-censored data. It provides custom fitting algorithms to fit distributions to i.i.d. samples as well as dynnamic TensorFlow integration to allow training neural networks with arbitrary output distributions. The latter can be used to include explanatory variables in the distributional fits. Reservr also provides some tools relevant for working with its core functionality in an actuarial setting, namely the functions <code><a href="reference/prob_report.html">prob_report()</a></code> and <code><a href="reference/truncate_claims.html">truncate_claims()</a></code>, both of which make assumptions on the type of random truncation applied to the data.</p>
<p>Please refer to the vignettes <code>distributions.Rmd</code> and <code>tensorflow.Rmd</code> for detailed introductions.</p>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>reservr is not yet on CRAN. You can install the latest development version of reservr via</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"AshesITR/reservr"</span><span class="op">)</span></code></pre></div>
<!-- You can install the released version of reservr from [CRAN](https://CRAN.R-project.org) with:
``` r
install.packages("reservr")
```
--->
<p>If you want to use all of reservrs features, make sure to also install <a href="https://tensorflow.rstudio.com/installation/">tensorflow</a>.</p>
</div>
<div id="example" class="section level2">
<h2 class="hasAnchor">
<a href="#example" class="anchor"></a>Example</h2>
<p>This is a basic example which shows how to fit a normal distribution to randomly truncated and censored data.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">reservr</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span>
<span class="va">mu</span> <span class="op">&lt;-</span> <span class="fl">0</span>
<span class="va">sigma</span> <span class="op">&lt;-</span> <span class="fl">1</span>
<span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">1000</span>
<span class="va">p_cens</span> <span class="op">&lt;-</span> <span class="fl">0.8</span>

<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">N</span>, mean <span class="op">=</span> <span class="va">mu</span>, sd <span class="op">=</span> <span class="va">sigma</span><span class="op">)</span>
<span class="va">is_censored</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span><span class="op">(</span><span class="va">N</span>, size <span class="op">=</span> <span class="fl">1L</span>, prob <span class="op">=</span> <span class="va">p_cens</span><span class="op">)</span> <span class="op">==</span> <span class="fl">1L</span>
<span class="va">x_lower</span> <span class="op">&lt;-</span> <span class="va">x</span>
<span class="va">x_lower</span><span class="op">[</span><span class="va">is_censored</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span><span class="va">is_censored</span><span class="op">]</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">is_censored</span><span class="op">)</span>, min <span class="op">=</span> <span class="fl">0</span>, max <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>
<span class="va">x_upper</span> <span class="op">&lt;-</span> <span class="va">x</span>
<span class="va">x_upper</span><span class="op">[</span><span class="va">is_censored</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span><span class="va">is_censored</span><span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">is_censored</span><span class="op">)</span>, min <span class="op">=</span> <span class="fl">0</span>, max <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>

<span class="va">t_lower</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="va">N</span>, min <span class="op">=</span> <span class="op">-</span><span class="fl">2</span>, max <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>
<span class="va">t_upper</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="va">N</span>, min <span class="op">=</span> <span class="fl">0</span>, max <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>

<span class="va">is_observed</span> <span class="op">&lt;-</span> <span class="va">t_lower</span> <span class="op">&lt;=</span> <span class="va">x</span> <span class="op">&amp;</span> <span class="va">x</span> <span class="op">&lt;=</span> <span class="va">t_upper</span>

<span class="va">obs</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/trunc_obs.html">trunc_obs</a></span><span class="op">(</span>
  xmin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">pmax</a></span><span class="op">(</span><span class="va">x_lower</span>, <span class="va">t_lower</span><span class="op">)</span><span class="op">[</span><span class="va">is_observed</span><span class="op">]</span>,
  xmax <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">pmin</a></span><span class="op">(</span><span class="va">x_upper</span>, <span class="va">t_upper</span><span class="op">)</span><span class="op">[</span><span class="va">is_observed</span><span class="op">]</span>,
  tmin <span class="op">=</span> <span class="va">t_lower</span><span class="op">[</span><span class="va">is_observed</span><span class="op">]</span>,
  tmax <span class="op">=</span> <span class="va">t_upper</span><span class="op">[</span><span class="va">is_observed</span><span class="op">]</span>
<span class="op">)</span>

<span class="co"># Summary of the simulation</span>
<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span>
  <span class="st">"simulated samples: %d\nobserved samples: %d\ncensored samples: %d\n"</span>, 
  <span class="va">N</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">obs</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">obs</span><span class="op">$</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>
<span class="op">)</span><span class="op">)</span>

<span class="co"># Define outcome distribution and perform fit to truncated and (partially) censored sample</span>
<span class="va">dist</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/dist_normal.html">dist_normal</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">the_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html">fit</a></span><span class="op">(</span><span class="va">dist</span>, <span class="va">obs</span><span class="op">)</span>

<span class="co"># Visualize resulting parameters and show a kernel density estimate of the samples.</span>
<span class="co"># We replace interval-censored samples with their midpoint for the kernel density estimate.</span>
<span class="fu"><a href="reference/plot_distributions.html">plot_distributions</a></span><span class="op">(</span>
  true <span class="op">=</span> <span class="va">dist</span>,
  fitted <span class="op">=</span> <span class="va">dist</span>, 
  empirical <span class="op">=</span> <span class="fu"><a href="reference/dist_empirical.html">dist_empirical</a></span><span class="op">(</span><span class="fl">0.5</span> <span class="op">*</span> <span class="op">(</span><span class="va">obs</span><span class="op">$</span><span class="va">xmin</span> <span class="op">+</span> <span class="va">obs</span><span class="op">$</span><span class="va">xmax</span><span class="op">)</span><span class="op">)</span>, 
  .x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>, <span class="fl">5</span>, length.out <span class="op">=</span> <span class="fl">201</span><span class="op">)</span>, 
  plots <span class="op">=</span> <span class="st">"density"</span>, 
  with_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
    true <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="va">mu</span>, sd <span class="op">=</span> <span class="va">sigma</span><span class="op">)</span>, 
    fitted <span class="op">=</span> <span class="va">the_fit</span><span class="op">$</span><span class="va">params</span>
  <span class="op">)</span>
<span class="op">)</span></code></pre></div>
</div>
<div id="code-of-conduct" class="section level2">
<h2 class="hasAnchor">
<a href="#code-of-conduct" class="anchor"></a>Code of Conduct</h2>
<p>Please note that the reservr project is released with a <a href="https://contributor-covenant.org/version/2/0/CODE_OF_CONDUCT.html">Contributor Code of Conduct</a>. By contributing to this project, you agree to abide by its terms.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Browse source code at <br><a href="https://github.com/AshesITR/reservr/">https://​github.com/​AshesITR/​reservr/​</a>
</li>
<li>Report a bug at <br><a href="https://github.com/AshesITR/reservr/issues">https://​github.com/​AshesITR/​reservr/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li>GPL</li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Alexander Rosenstock <br><small class="roles"> Author, maintainer, copyright holder </small>  </li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://codecov.io/gh/AshesITR/reservr?branch=master"><img src="https://codecov.io/gh/AshesITR/reservr/branch/master/graph/badge.svg" alt="Codecov test coverage"></a></li>
<li><a href="https://github.com/AshesITR/reservr/actions"><img src="https://github.com/AshesITR/reservr/workflows/R-CMD-check/badge.svg" alt="R-CMD-check"></a></li>
</ul>
</div>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by Alexander Rosenstock.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
